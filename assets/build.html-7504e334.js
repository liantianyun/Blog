import{_ as n,p as s,q as a,a1 as e}from"./framework-5866ffd3.js";const t="/assets/gitactions-6a33566d.png",p={},c=e(`<h1 id="本站的建站过程" tabindex="-1"><a class="header-anchor" href="#本站的建站过程" aria-hidden="true">#</a> 本站的建站过程</h1><p>如你所见，本站的目前已实现的所有功能都是使用VuePress2搭建的，因此，如果你想实现本站的某个功能，一般而言只要参考官方文档即可。</p><p>本站部署在Github Page上，在“部署”这个环节，参考官网文档遇到了问题。</p><p>在此记录解决方案。</p><p>官方文档提供的git action配置文件是有误的，其中的42~51行的配置：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy to GitHub Pages
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> crazy<span class="token punctuation">-</span>max/ghaction<span class="token punctuation">-</span>github<span class="token punctuation">-</span>pages@v2
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token comment"># 部署到 gh-pages 分支</span>
          <span class="token key atrule">target_branch</span><span class="token punctuation">:</span> gh<span class="token punctuation">-</span>pages
          <span class="token comment"># 部署目录为 VuePress 的默认输出目录</span>
          <span class="token key atrule">build_dir</span><span class="token punctuation">:</span> docs/.vuepress/dist
        <span class="token key atrule">env</span><span class="token punctuation">:</span>
          <span class="token comment"># @see https://docs.github.com/cn/actions/reference/authentication-in-a-workflow#about-the-github_token-secret</span>
          <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行的是将main分支构建后的文件对送到gh-pages分支的任务，但<code>crazy-max/ghaction-github-pages@v2</code>这个库有点问题，你可以改为使用更为知名的<code>peaceiris/actions-gh-pages@v3</code>这个库，将配置文件这段配置替换为如下配置即可：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Build VuePress site
        <span class="token key atrule">run</span><span class="token punctuation">:</span> pnpm docs<span class="token punctuation">:</span>build

      <span class="token comment"># 查看 workflow 的文档来获取更多信息</span>
      <span class="token comment"># @see https://github.com/crazy-max/ghaction-github-pages</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy to GitHub Pages
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> peaceiris/actions<span class="token punctuation">-</span>gh<span class="token punctuation">-</span>pages@v3
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token comment"># 部署目录为 VuePress 的默认输出目录</span>
          <span class="token key atrule">github_token</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
          <span class="token key atrule">publish_dir</span><span class="token punctuation">:</span> docs/.vuepress/dist
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>另外，你还需要确保你的远程仓库中，某些配置正确才可以正常部署，具体为：</p><p>在你的github仓库中，依次点击: <code>Setting-&gt;Actions-&gt;General</code>,确保底部的<code>Workflow permissions</code>配置选择的是<code>Read and Write permissions</code>，否则在执行推送构建文件到gh-pages分支的时候会因为权限不足遇到403错误，如下图： <img src="`+t+'" alt=""></p>',10),i=[c];function o(l,u){return s(),a("div",null,i)}const r=n(p,[["render",o],["__file","build.html.vue"]]);export{r as default};
