# 哈希表面试相关问题

不论在什么语言中，映射这种结构的重要性都是不言而喻的，但映射本身是一种高级数据结构，底层实现可以采用不同的数据结构，大多数情况下我们都是用无序映射的，这种情况下往往底层都会采用哈希表来实现，下面是一些哈希表相关的面试问题以及我的模拟回答（只是基于自己的理解，不一定准确）。

map的底层原理是什么？

面试官期望的应该就是你要答出哈希表。但你也可以超出他的期望比较全面的回答：映射本身是一种高级数据结构，底层实现可以采用BST、AVL、红黑树或者哈希表等等，映射本身是一种精确定义的数据结构，只要实现相关接口都可以称为映射，一般来说(在java中），有序映射往往采用红黑树或者avl实现（BST本身具有有序性），无序映射往往采用哈希表实现。

hashtable的底层原理是什么？

数组。哈希表的本质就是一个数组。数组支持随机访问，往往适用于索引具有语义的情况，而哈希函数的作用就是赋予索引语义，所以哈希表的时间复杂度度为O（1）（在不考虑哈希冲突的情况下）

为什么会有哈希冲突？（这个问题是我yy出来的，主要是为了回答下一个问题）

理解了哈希表的工作方式以后，接受会发生哈希冲突似乎是一件很自然的事情，但如果让你精确这个问题回答好像很难...我的理解是这几乎是任何哈希函数都不可避免的性质了（本质原因还是数组空间有限，不然不会存在哈希冲突）

常见的哈希冲突的解决方式有什么？

链地址法（Java中采用、又叫封闭地址法）数组中的每个位置在相应的存储一个查找表（即必须实现get（key）方法、如链表、树都可以），发生冲突后直接在该结构上处存储，这时hashtable查找的时间复杂度就转化为这个结构的查找时间复杂度。

用链表：O（N/M） 

用树：O（log（N/M））

其中，N代表元素数，M代表当前数组空间数

开放地址法（包括这次软考考了的线性探查法，平方探查，二次哈希等等）：本质就是冲突以后通过一个算法再次寻找一个可用位置，在python中的dict底层哈希表实现中就是用二次探查法。

什么时候需要哈希扩容，如何哈希扩容？

首先必须明白，什么时候进行哈希扩容是根据你选择的解决哈希冲突的方式来决定的，对于封闭地址法来说，往往依据每个位置上已经存储的数据规模有关，至于这个指标是多少，可以自己决定（缩容同理），增加了扩容操作后哈希表的均摊复杂度仍为O（1）

对于开放地址法来说，要引入负载率这个指标（当前已存储元素占总容量的百分比），跟上面同理，你可以自己定达到多少负载率就进行扩容操作。

那么如何扩容？跟动态数组扩容直接拷贝略有不同，需要重新让每个元素根据哈希函数（数组容量往往是哈希函数中的一个参数，所以会得到不同的结果。）重新计算一遍新的哈希值在存储至相应位置。

如何设计一个哈希函数？

吐槽一下...尽管设计哈希函数的方式方法复杂多样，但设计一个性能比较好的哈希函数我依然觉得难度很大，至少我一个都想不出来...不过这题是来源于头条的面试真题

这里提供一种我学过的：

整数取模法：

思路很简单：把所有数据都转化为整数表示，在模上一个数，就可以得到一个哈希值（说不出细节给个思路也是好的吧..）。

那么这个问题就转化为以下两个问题：

如何把各种类型的数据转化为整数：

整数：不用转化

浮点数：可以转化成整数处理（并不是直接去掉小数部分那种转化，而是把这个浮点树的二进制表示形式让计算机当成整数来解析，这个我也只知道思想，不知道怎么实现，不过Java有封装好的方法可以用...）。

字符串：字符串的转化需要灵活运用进制的思想。把一个整数字符串转化成整数的算法很多人都写过，比如把'555'转化成整数，你多半会想到把三个字符拆开，第一个5乘上10的2次方，第二个乘上10的1次方，以此类推，最后加起来就可以。这里面隐含了一个思想：有多少有限的不同的符号，你就可以制定一个多少进制的规则，比说说小写字母字符串'abc'，你就可以理解为一个26进制的整数，把第一位a理解为1*26^2，b理解为2*26^1，以此类推，在这个思想指导下，你可以解决任意符号串转整数的问题（在一个著名的系统设计题“短网址设计”中，也可以采用这个思想构建算法）。

类:类的属性无非就是以上的组合，你可以各自计算然后加起来，类的方法忽略也可以，也可以把方法名当作属性名，反正哈希函数规则你定，怎么定都是能出结果的，只是可能不同的设计方式会得到不同性能的结果。

第二个问题是取模的那个数怎么取？

直径说结论，模一个素数，至于为什么，背后的数学理论我也不懂，有兴趣的可以自己找资料学，有人列了一个表，根据不同的数据规模都给了一个对于素数的参考值，直接用就可以。

以上对于map相关的内容，对于set同样适用。

相信以上几个问题答得出来，应付哈希表相关的面试问题应该是绰绰有余了...

再次申明，以上仅仅是我基于目前已有的知识储备模拟的如果面试被问到会怎么回答，并不是标准答案，有出错也是很正常的，如果小伙伴发现了错误欢迎指出~